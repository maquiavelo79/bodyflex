
-- CALL SP_OTROS_INGRESA_MODIFICA('13661574','0','NOM1','01/01/2000','111111111','DESC1',1);
-- CALL SP_OTROS_INGRESA_MODIFICA('13661574','0','NOM2','01/01/2000','222222222','DESC2',2);
-- CALL SP_OTROS_INGRESA_MODIFICA('13661574','0','NOM3','01/01/2000','333333333','DESC3',3);

-- CALL SP_OTROS_INGRESA_MODIFICA('13661574','11','NOM8','01/01/2001','88888888888','DESC8',1);
-- CALL SP_OTROS_INGRESA_MODIFICA('13661574','12','NOM9','01/02/2002','99999999999','DESC9',2);
-- CALL SP_OTROS_INGRESA_MODIFICA('13661574','13','NOM10','01/03/2003','77777777777','DESC7',3);
   
-- SELECT * FROM PROFESIONAL
-- SELECT * FROM CURRICULUM
-- SELECT * FROM OTRO;

DROP PROCEDURE IF EXISTS bodyflex.SP_WAPP_PUBLICACION_CUENTA_VISITA;
CREATE PROCEDURE bodyflex.`SP_WAPP_PUBLICACION_CUENTA_VISITA`( 
                                                        IN puId VARCHAR(20)
                                                        , IN sesion VARCHAR(30)
                                                        , OUT codErr INTEGER
                                                      )
BEGIN
DECLARE EXIT HANDLER FOR SQLEXCEPTION SET codErr=99;
SET codErr=0;
    IF NOT EXISTS(SELECT * FROM PUBLICACION_VISITAS WHERE PUID=puId AND VISSES=sesion) THEN  
      INSERT INTO PUBLICACION_VISITAS(
        puID
        , visFec
        , visSes
      )VALUES(
        puId
        , NOW()
        , sesion
      );
      SELECT 1;
    ELSE
      SET codErr=98;
    END IF;  
        
END;
